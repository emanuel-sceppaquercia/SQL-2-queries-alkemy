-- 1. Escriba una consulta que devuelva el legajo y la cantidad de cursos que realiza cada estudiante.

SELECT e.legajo, COUNT(*) AS "Cant cursos"
FROM estudiante e INNER JOIN inscripcion i 
ON e.legajo = i.estudiante_legajo
GROUP BY e.legajo;

-- 2. Escriba una consulta que devuelva el legajo y la cantidad de cursos de los estudiantes 
-- que realizan más de un curso.

SELECT e.legajo, COUNT(*) AS "Cant cursos"
FROM estudiante e INNER JOIN inscripcion i 
ON e.legajo = i.estudiante_legajo
GROUP BY e.legajo
HAVING COUNT(*) > 1;

-- 3. Escriba una consulta que devuelva la información de los estudiantes que no realizan ningún curso.

SELECT * FROM estudiante e
WHERE e.legajo NOT IN(
	SELECT i.estudiante_legajo
    FROM inscripcion i 
    GROUP BY i.estudiante_legajo
);

-- 4. Escriba para cada tabla, los index (incluyendo su tipo) que tiene cada una.

-- Tabla profesor: index id, tipo INT, primary key (clousterizado)
-- Tabla curso: index codigo, tipo INT, primary key (clousterizado)
-- Tabla incripcion: index numero, tipo INT, primary key (clousterizado)
-- Tabla estuaidnte: index legajo, tipo INT, primary key (clousterizado)

-- 5. Liste toda la información sobre los estudiantes que realizan cursos con los profesores 
-- de apellido “Pérez” y “Paz”.

SELECT * FROM estudiante e
WHERE e.legajo IN(
	SELECT i.estudiante_legajo
    FROM inscripcion i
    WHERE i.curso_codigo IN(
    	SELECT c.codigo
        FROM curso c 
        WHERE c.profesor_id IN(
        	SELECT p.id FROM profesor p
			WHERE p.apellido IN ("Pérez","Paz")
        )
    )
)
